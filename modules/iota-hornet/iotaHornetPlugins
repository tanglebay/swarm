#!/bin/bash

if [[ $iotaHornetVersion =~ ^1.* ]]; then
    if [ "$useIotaHornetEnablePlugins" = "true" ]; then
        iotaHornetPlugins=$iotaHornetEnablePlugins
    fi
    if [ "$useHornetDisablePlugins" = "true" ]; then
        iotaHornetPlugins=$iotaHornetDisablePlugins
    fi

    ### PLUGINS ###

    # Autopeering
    if [[ $iotaHornetPlugins = *autopeering* ]]; then
        iotaHornetPluginAutopeering=OFF
        if [ "$ufw" = "true" ]; then
            sudo ufw allow $iotaHornetAutopeeringPort/udp > /dev/null 2>&1
        fi
    else
        iotaHornetPluginAutopeering=ON
        if [ "$ufw" = "true" ]; then
            sudo ufw delete allow $iotaHornetAutopeeringPort/udp > /dev/null 2>&1
        fi
    fi

    # MQTT
    if [[ $iotaHornetPlugins = *mqtt* ]]; then
        iotaHornetPluginMqtt=OFF
    else
        iotaHornetPluginMqtt=ON
    fi

    # Faucet
    if [[ $iotaHornetPlugins = *faucet* ]]; then
        iotaHornetPluginFaucet=OFF
    else
        iotaHornetPluginFaucet=ON
    fi

    # Warpsync
    if [[ $iotaHornetPlugins = *warpsync* ]]; then
        iotaHornetPluginWarpsync=OFF
    else
        iotaHornetPluginWarpsync=ON
    fi

    # Prometheus
    if [[ $iotaHornetPlugins = *prometheus* ]]; then
        iotaHornetPluginPrometheus=OFF
    else
        iotaHornetPluginPrometheus=ON
    fi

    # Participation
    if [[ $iotaHornetPlugins = *participation* ]]; then
        iotaHornetPluginParticipation=OFF
    else
        iotaHornetPluginParticipation=ON
    fi

    # POI
    if [[ $iotaHornetPlugins = *poi* ]]; then
        iotaHornetPluginPoi=OFF
    else
        iotaHornetPluginPoi=ON
    fi

    unset iotaHornetPlugins
fi
