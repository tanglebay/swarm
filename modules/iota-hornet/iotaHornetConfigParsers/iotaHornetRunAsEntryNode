#!/bin/bash

if [ "$iotaHornetReleaseVersion" = "v2" ] && [ ! -z "$iotaHornetReleaseVersion" ]; then
    parser="$(jq '.p2p.autopeering.runAsEntryNode' $iotaHornetHome/$iotaHornetConfig.json)"
    if [ "$iotaHornetRunAsEntryNode" = "true" ] || [ "$iotaHornetRunAsEntryNode" = "false" ]; then
        if [ "$parser" != "$iotaHornetRunAsEntryNode" ]; then
            sudo jq '.p2p.autopeering.runAsEntryNode = '$iotaHornetRunAsEntryNode'' $iotaHornetHome/$iotaHornetConfig.json|sponge $iotaHornetHome/$iotaHornetConfig.json
            restartIotaHornet=true
            echo "iotaHornetRunAsEntryNode" >> /tmp/iotaHornetParsing
        fi
    fi
else
    parser="$(jq '.p2p.autopeering.runAsEntryNode' $iotaHornetHome/$iotaHornetConfig.json)"
    if [ "$iotaHornetRunAsEntryNode" = "true" ] || [ "$iotaHornetRunAsEntryNode" = "false" ]; then
        if [ "$parser" != "$iotaHornetRunAsEntryNode" ]; then
            sudo jq '.p2p.autopeering.runAsEntryNode = '$iotaHornetRunAsEntryNode'' $iotaHornetHome/$iotaHornetConfig.json|sponge $iotaHornetHome/$iotaHornetConfig.json
            restartIotaHornet=true
            echo "iotaHornetRunAsEntryNode" >> /tmp/iotaHornetParsing
        fi
    fi
fi
