#!/bin/bash

if [ "$(printf '%s\n' "$iotaHornetStardustMinVersion" "$iotaHornetVersion" | sort -V | head -n1)" != "$iotaHornetStardustMinVersion" ] && [ ! -z "$iotaHornetVersion" ]; then
    parser="$(jq '.p2p.autopeering.enabled' $iotaHornetHome/$iotaHornetConfig.json)"
    if [ "$iotaHornetAutopeeringEnabled" = "true" ] || [ "$iotaHornetAutopeeringEnabled" = "false" ]; then
        if [ "$parser" != "$iotaHornetAutopeeringEnabled" ]; then
            sudo jq '.p2p.autopeering.enabled = '$iotaHornetAutopeeringEnabled'' $iotaHornetHome/$iotaHornetConfig.json|sponge $iotaHornetHome/$iotaHornetConfig.json
            restartIotaHornet=true
            echo "iotaHornetAutopeeringEnabled" >> /tmp/iotaHornetParsing
        fi
    fi
fi