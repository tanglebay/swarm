#!/bin/bash

if [ "$(printf '%s\n' "$iotaHornetVersion" "$iotaHornetStardustMinVersion" | sort -V | head -n1)" != "$iotaHornetStardustMinVersion" ] && [ ! -z "$iotaHornetVersion" ]; then
    parser="$(jq '.mqtt.bindAddress' $iotaHornetHome/$iotaHornetConfig.json)"
    parser=$(echo $parser | tr -d '"')
    if [ "$parser" != "localhost:1883" ]; then
        sudo jq '.mqtt.bindAddress = "localhost:1883"' $iotaHornetHome/$iotaHornetConfig.json|sponge $iotaHornetHome/$iotaHornetConfig.json
        restartIotaHornet=true
        echo "iotaHornetMqtt" >> /tmp/iotaHornetParsing
    fi
fi
