#!/bin/bash

if [ "$iotaHornetNetwork" = "mainnet" ]; then
    iotaHornetFullSnapshotUrl="https://cdn.tanglebay.com/snapshots/iota-mainnet/full_snapshot.bin"
    iotaHornetDeltaSnapshotUrl="https://cdn.tanglebay.com/snapshots/iota-mainnet/delta_snapshot.bin"
    parser="$(jq '.snapshots.downloadURLs' $iotaHornetHome/$iotaHornetConfig.json)"
    if [[ $parser != *$iotaHornetFullSnapshotUrl* ]] && [[ $parser != *$iotaHornetDeltaSnapshotUrl* ]]; then
        sudo jq '.snapshots.downloadURLs[.snapshots.downloadURLs| length] |= . - {"full": "'$iotaHornetFullSnapshotUrl'","delta": "'$iotaHornetDeltaSnapshotUrl'"}' $iotaHornetHome/$iotaHornetConfig.json|sponge $iotaHornetHome/$iotaHornetConfig.json
        restartIotaHornet=true
        echo "iotaHornetSnapshotUrl" >> /tmp/iotaHornetParsing
    fi
    unset parser iotaHornetFullSnapshot
fi