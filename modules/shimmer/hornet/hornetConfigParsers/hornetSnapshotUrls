#!/bin/bash
if [ "$hornetNetwork" = "mainnet" ]; then
    hornetFullSnapshotOld="https://cdn.tanglebay.com/snapshots/mainnet/full_snapshot.bin"
    hornetDeltaSnapshotOld="https://cdn.tanglebay.com/snapshots/mainnet/delta_snapshot.bin"
    hornetFullSnapshot="https://cdn.tanglebay.com/snapshots/iota-mainnet/full_snapshot.bin"
    hornetDeltaSnapshot="https://cdn.tanglebay.com/snapshots/iota-mainnet/delta_snapshot.bin"
    parser="$(jq '.snapshots.downloadURLs' $hornetHome/config.json)"
    if [[ $parser = *$hornetFullSnapshotOld* ]] && [[ $parser = *$hornetDeltaSnapshotOld* ]]; then
        sudo sudo sed -i 's~'$hornetFullSnapshotOld'~'$hornetFullSnapshot'~g' $hornetHome/config.json
        sudo sudo sed -i 's~'$hornetDeltaSnapshotOld'~'$hornetDeltaSnapshot'~g' $hornetHome/config.json
        restartHornet=true
        echo "hornetSnapshotUrl" >> /tmp/hornetParsing
    fi
    parser="$(jq '.snapshots.downloadURLs' $hornetHome/config.json)"
    if [[ $parser != *$hornetFullSnapshot* ]] && [[ $parser != *$hornetDeltaSnapshot* ]]; then
        sudo jq '.snapshots.downloadURLs[.snapshots.downloadURLs| length] |= . + {"full": "'$hornetFullSnapshot'","delta": "'$hornetDeltaSnapshot'"}' $hornetHome/config.json|sponge $hornetHome/config.json
        restartHornet=true
        echo "hornetSnapshotUrl" >> /tmp/hornetParsing
    fi
    unset hornetFullSnapshot
    unset parser
fi
