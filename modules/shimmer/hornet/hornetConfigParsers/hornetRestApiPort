#!/bin/bash

parser=$(jq '.restAPI.bindAddress' $hornetShimmerHome/$hornetShimmerConfig.json)
parser=$(echo $parser | tr -d '"')
if [ "$parser" != "0.0.0.0:14267" ]; then
    sudo jq '.restAPI.bindAddress = "0.0.0.0:14267"' $hornetShimmerHome/$hornetShimmerConfig.json|sponge $hornetShimmerHome/$hornetShimmerConfig.json
    if [ -f "/etc/nginx/sites-enabled/hornet-shimmer" ]; then
        sudo find /etc/nginx/sites-enabled/hornet-shimmer -type f -exec sed -i 's/14265/14267/g' {} \;
        sudo systemctl reload nginx
    fi
    restartShimmerHornet=true
    echo "hornetShimmerRestApiPort" >> /tmp/hornetShimmerParsing
fi