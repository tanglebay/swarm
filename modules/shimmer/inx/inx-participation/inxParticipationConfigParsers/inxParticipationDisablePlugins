#!/bin/bash

useInxParticipationDisablePlugins=true
source $shimmerInxParticipationModules/inxParticipationPlugins

IFS=', ' read -r -a ARRAYshimmerInxParticipationDisablePlugins <<< "$shimmerInxParticipationDisablePlugins"

parser="$(jq '.app.disablePlugins' $shimmerInxParticipationHome/$shimmerInxParticipationConfig.json)"
parser="$(echo $parser | tr -d '[]" ')"
if [ "$parser" != "$shimmerInxParticipationDisablePlugins" ]; then
    sudo jq '.app.disablePlugins |= []' $shimmerInxParticipationHome/$shimmerInxParticipationConfig.json|sponge $shimmerInxParticipationHome/$shimmerInxParticipationConfig.json
    for shimmerInxParticipationDisablePlugin in "${ARRAYshimmerInxParticipationDisablePlugins[@]}"
    do
        if [ ! -z "$shimmerInxParticipationDisablePlugin" ]; then
            sudo jq '.app.disablePlugins |= .+ ["'$shimmerInxParticipationDisablePlugin'"]' $shimmerInxParticipationHome/$shimmerInxParticipationConfig.json|sponge $shimmerInxParticipationHome/$shimmerInxParticipationConfig.json
        fi
    done
    restartShimmerInxParticipation=true
    echo "shimmerInxParticipationDisablePlugins" >> /tmp/shimmerInxParticipationParsing
fi
unset ARRAYshimmerInxParticipationDisablePlugins shimmerInxParticipationDisablePlugin useShimmerInxParticipationDisablePlugins
