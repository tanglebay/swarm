#!/bin/bash

# Unset VARS
unset shimmerInxIndexerApiPublicRoutes

#/api/indexer/v1/*
if [[ $shimmerInxIndexerApiRoutes = */api/indexer/v1/\** ]]; then
    shimmerInxIndexerApiRoutesIndexer=OFF
else
    shimmerInxIndexerApiRoutesIndexer=ON
    shimmerInxIndexerApiPublicRoutes="/api/indexer/v1/*"
fi

######

shimmerInxIndexerApiPublicRoutes=$(echo "$shimmerInxIndexerApiPublicRoutes" | tr -s ',,' ',')
validateShimmerHornetApiPublicRoutes=$(echo "${shimmerInxIndexerApiPublicRoutes: -1}")
if [ "$validateShimmerHornetApiPublicRoutes" = "," ]; then
    shimmerInxIndexerApiPublicRoutes="${shimmerInxIndexerApiPublicRoutes%?}"
fi

if [ "$shimmerInxIndexerUpdateApiRoutes" = "true" ] && [ "$shimmerInxIndexerApiPublicRoutes" != "$shimmerInxIndexerApiRoutes" ]; then
    sudo sed -i 's~^shimmerInxIndexerApiPublicRoutes=.*~shimmerInxIndexerApiPublicRoutes="'$shimmerInxIndexerApiPublicRoutes'"~' $swarmConfigs/shimmer-inx-indexer.cfg
    restartShimmerHornet=true
fi
