#!/bin/bash
source $swarmConfigs/swarm.cfg

# Watchdog
# crontab -l | grep -q "$watchdogCronCmd" && watchdogStatus=enabled || watchdogStatus=disabled > /dev/null 2>&1

if [ "$iotaHornetAutoUpdate" = "true" ]; then
    iotaHornetAutoUpdateStatus="enabled"
else
    iotaHornetAutoUpdateStatus="disabled"
fi

if [ "$shimmerHornetAutoUpdate" = "true" ]; then
    shimmerHornetAutoUpdateStatus="enabled"
else
    shimmerHornetAutoUpdateStatus="disabled"
fi

if [ "$iotaBeeAutoUpdate" = "true" ]; then
    iotaBeeAutoUpdateStatus="enabled"
else
    iotaBeeAutoUpdateStatus="disabled"
fi

if [ "$iotaShimmerBeeAutoUpdate" = "true" ]; then
    shimmerBeeAutoUpdateStatus="enabled"
else
    shimmerBeeAutoUpdateStatus="disabled"
fi

if [ "$goshimmerAutoUpdate" = "true" ]; then
    goshimmerAutoUpdateStatus="enabled"
else
    goshimmerAutoUpdateStatus="disabled"
fi

if [ "$waspAutoUpdate" = "true" ]; then
    waspAutoUpdateStatus="enabled"
else
    waspAutoUpdateStatus="disabled"
fi

if [ "$shimmerInxIndexerAutoUpdate" = "true" ]; then
    shimmerInxIndexerAutoUpdateStatus="enabled"
else
    shimmerInxIndexerAutoUpdateStatus="disabled"
fi

if [ "$shimmerInxMqttAutoUpdate" = "true" ]; then
    shimmerInxMqttAutoUpdateStatus="enabled"
else
    shimmerInxMqttAutoUpdateStatus="disabled"
fi

if [ "$shimmerInxParticipationAutoUpdate" = "true" ]; then
    shimmerInxParticipationAutoUpdateStatus="enabled"
else
    shimmerInxParticipationAutoUpdateStatus="disabled"
fi

# Sync Check
if [ "$iotaHornetCheckSync" = "true" ]; then
    iotaHornetCheckSyncStatus="enabled"
else
    iotaHornetCheckSyncStatus="disabled"
fi

if [ "$shimmerHornetCheckSync" = "true" ]; then
    shimmerHornetCheckSyncStatus="enabled"
else
    shimmerHornetCheckSyncStatus="disabled"
fi

if [ "$iotaBeeCheckSync" = "true" ]; then
    beeCheckSyncStatus="enabled"
else
    beeCheckSyncStatus="disabled"
fi

if [ "$iotaShimmerBeeCheckSync" = "true" ]; then
    shimmerBeeCheckSyncStatus="enabled"
else
    shimmerBeeCheckSyncStatus="disabled"
fi

if [ "$goshimmerCheckSync" = "true" ]; then
    goshimmerCheckSyncStatus="enabled"
else
    goshimmerCheckSyncStatus="disabled"
fi

# DB Reset
if [ "$iotaHornetAllowDbReset" = "true" ]; then
    hornetAllowDbResetStatus="enabled"
else
    hornetAllowDbResetStatus="disabled"
fi

if [ "$shimmerHornetAllowDbReset" = "true" ]; then
    shimmerHornetAllowDbResetStatus="enabled"
else
    shimmerHornetAllowDbResetStatus="disabled"
fi

if [ "$iotaBeeAllowDbReset" = "true" ]; then
    iotaBeeAllowDbResetStatus="enabled"
else
    iotaBeeAllowDbResetStatus="disabled"
fi

if [ "$iotaShimmerBeeAllowDbReset" = "true" ]; then
    shimmerBeeAllowDbResetStatus="enabled"
else
    shimmerBeeAllowDbResetStatus="disabled"
fi

if [ "$goshimmerAllowDbReset" = "true" ]; then
    goshimmerAllowDbResetStatus="enabled"
else
    goshimmerAllowDbResetStatus="disabled"
fi

if [ "$waspAllowDbReset" = "true" ]; then
    waspAllowDbResetStatus="enabled"
else
    waspAllowDbResetStatus="disabled"
fi

if [ "$shimmerInxIndexerAllowDbReset" = "true" ]; then
    shimmerInxIndexerAllowDbResetStatus="enabled"
else
    shimmerInxIndexerAllowDbResetStatus="disabled"
fi

if [ "$shimmerInxParticipationAllowDbReset" = "true" ]; then
    shimmerInxParticipationAllowDbResetStatus="enabled"
else
    shimmerInxParticipationAllowDbResetStatus="disabled"
fi

if [ "$goshimmerAllowDbDownload" = "true" ]; then
    goshimmerAllowDbDownloadStatus="enabled"
else
    goshimmerAllowDbDownloadStatus="disabled"
fi

# Service Check
if [ "$iotaHornetServiceStatusCheck" = "true" ]; then
    hornetServiceStatusCheckStatus="enabled"
else
    hornetServiceStatusCheckStatus="disabled"
fi

if [ "$shimmerHornetServiceStatusCheck" = "true" ]; then
    shimmerHornetServiceStatusCheckStatus="enabled"
else
    shimmerHornetServiceStatusCheckStatus="disabled"
fi

if [ "$iotaBeeServiceStatusCheck" = "true" ]; then
    iotaBeeServiceStatusCheckStatus="enabled"
else
    iotaBeeServiceStatusCheckStatus="disabled"
fi

if [ "$iotaShimmerBeeServiceStatusCheck" = "true" ]; then
    shimmerBeeServiceStatusCheckStatus="enabled"
else
    shimmerBeeServiceStatusCheckStatus="disabled"
fi

if [ "$goshimmerServiceStatusCheck" = "true" ]; then
    goshimmerServiceStatusCheckStatus="enabled"
else
    goshimmerServiceStatusCheckStatus="disabled"
fi

if [ "$waspServiceStatusCheck" = "true" ]; then
    waspServiceStatusCheckStatus="enabled"
else
    waspServiceStatusCheckStatus="disabled"
fi

if [ "$shimmerInxIndexerServiceStatusCheck" = "true" ]; then
    shimmerInxIndexerServiceStatusCheckStatus="enabled"
else
    shimmerInxIndexerServiceStatusCheckStatus="disabled"
fi

if [ "$shimmerInxMqttServiceStatusCheck" = "true" ]; then
    shimmerInxMqttServiceStatusCheckStatus="enabled"
else
    shimmerInxMqttServiceStatusCheckStatus="disabled"
fi

if [ "$shimmerInxParticipationServiceStatusCheck" = "true" ]; then
    shimmerInxParticipationServiceStatusCheckStatus="enabled"
else
    shimmerInxParticipationServiceStatusCheckStatus="disabled"
fi

# Log Pruning
if [ "$swarmLogRotation" = "true" ]; then
    swarmLogRotation=enabled
else
    swarmLogRotation=disabled
fi

if [ "$swarmAutoUpdate" = "true" ]; then
    swarmAutoUpdateStatus=enabled
else
    swarmAutoUpdateStatus=disabled
fi

if [ "$ufw" = "true" ]; then
    firewallStatus=$(ufw status | grep -o "inactive")
    if [ "$firewallStatus" = "inactive" ]; then
        firewall=disabled
    else
        firewall=enabled
    fi
fi

if [ "$telegramNotifications" = "true" ] && [ ! -z "$telegramBotToken" ] && [ ! -z "$telegramChannelId" ]; then
    telegramNotifiactionsStatus=enabled
else
    telegramNotifiactionsStatus=disabled
fi

if [ -f "/usr/bin/iota-hornet" ]; then
    swarmInfoIotaHornet="\nHornet Autoupdater: $iotaHornetAutoUpdateStatus\nHornet Sync-check: $iotaHornetCheckSyncStatus\nMax unsync: $iotaHornetMaxMilestones milestones\nHornet DB-Reset: $iotaHornetAllowDbResetStatus\nHornet service check: $iotaHornetServiceStatusCheckStatus\n"
fi

if [ -f "/usr/bin/shimmer-hornet" ]; then
    swarmInfoShimmerHornet="\nHornet-Shimmer Autoupdater: $shimmerHornetAutoUpdateStatus\nHornet-Shimmer Sync-check: $shimmerHornetCheckSyncStatus\nMax unsync: $shimmerHornetMaxMilestones milestones\nHornet-Shimmer DB-Reset: $shimmerHornetAllowDbResetStatus\n$shimmerHornetServiceStatusCheckStatus\n"
fi

if [ -f "/usr/bin/iota-bee" ]; then
    swarmInfoBee="\nBee Autoupdater: $iotaBeeAutoUpdateStatus\nBee Sync-check: $iotaBeeCheckSyncStatus\nMax unsync: $iotaBeeMaxMilestones milestones\nBee DB-Reset: $iotaBeeAllowDbResetStatus\n$iotaBeeServiceStatusCheckStatus\n"
fi

if [ -f "/usr/bin/shimmer-bee" ]; then
    swarmInfoShimmerBee="\nBee-Shimmer Autoupdater: $iotaShimmerBeeAutoUpdateStatus\nBee-Shimmer Sync-check: $iotaShimmerBeeCheckSyncStatus\nMax unsync: $iotaShimmerBeeMaxMilestones milestones\nBee-Shimmer DB-Reset: $iotaShimmerBeeAllowDbResetStatus\n$iotaShimmerBeeServiceStatusCheckStatus\n"
fi

if [ -f "/usr/bin/goshimmer" ]; then
    swarmInfoGoshimmer="\nGoShimmer Autoupdater: $goshimmerAutoUpdateStatus\nGoShimmer Sync-check: $goshimmerCheckSyncStatus\nGoShimmer DB download: $goshimmerAllowDbDownloadStatus\nGoShimmer DB-Reset: $goshimmerAllowDbResetStatus\n$goshimmerServiceStatusCheckStatus\n"
fi

if [ -f "/usr/bin/wasp" ]; then
    swarmInfoWasp="\nWasp Autoupdater: $waspAutoUpdateStatus\nWasp Service Check: $shimmerInxIndexerServiceStatusCheck\nWasp DB-Reset: $waspAllowDbResetStatus\n$waspServiceStatusCheckStatus\n"
fi

if [ -f "/usr/bin/shimmer-inx-indexer" ]; then
    swarmInfoShimmerInxIndexer="\nINX-Indexer Autoupdater: $shimmerInxIndexerAutoUpdateStatus\nINX-Indexer DB-Reset: $shimmerInxIndexerAllowDbResetStatus\nINX-Indexer Service Check: $shimmerInxIndexerServiceStatusCheckStatus\n"
fi

if [ -f "/usr/bin/shimmer-inx-mqtt" ]; then
    swarmInfoShimmerInxMqtt="\nINX-MQTT Autoupdater: $shimmerInxMqttAutoUpdateStatus\nINX-MQTT Service Check: $shimmerInxMqttServiceStatusCheckStatus\n"
fi

if [ -f "/usr/bin/shimmer-inx-participation" ]; then
    swarmInfoShimmerInxParticipation="\nINX-Participation Autoupdater: $shimmerInxParticipationAutoUpdateStatus\nINX-Participation DB-Reset: $shimmerInxParticipationAllowDbResetStatus\nINX-Participation Service Check: $shimmerInxParticipationServiceStatusCheckStatus\n"
fi

if [ "$swarmInfo" = "true" ]; then
        # OUTPUT
        whiptail --scrolltext --title "SWARM Info [v$version]" --msgbox "Theme: \"$swarmTheme\"\n\nTelegram Notifications: $telegramNotifiactionsStatus\n\nSWARM updater: $swarmAutoUpdateStatus\nLog rotation: $swarmLogRotation\nMax log size: ${swarmLogSize} MB\n\nFirewall: $firewall\n${swarmInfoIotaHornet}${swarmInfoShimmerHornet}${swarmInfoIotaBee}${swarmInfoShimmerBee}${swarmInfoGoshimmer}${swarmInfoWasp}${swarmInfoShimmerInxIndexer}${swarmInfoShimmerInxMqtt}${swarmInfoShimmerInxParticipation}" 24 65
fi
