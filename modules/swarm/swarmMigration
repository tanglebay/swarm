#!/bin/bash

if [ -f "/usr/bin/hornet" ]; then
    sudo systemctl stop hornet
    [ -f "/etc/systemd/system/multi-user.target.wants/hornet.service" ]; then
        sudo systemctl disable hornet
        sudo systemctl daemon-reload
    fi
    if [ -d "/var/lib/hornet" ]; then
        sudo mv /var/lib/hornet /var/lib/iota-hornet
    fi
    if [ -f "/usr/bin/hornet" ]; then
        sudo mv /usr/bin/hornet /usr/bin/iota-hornet
    fi
    if [ -f "/etc/default/hornet" ]; then
        sudo mv /etc/default/hornet /etc/default/iota-hornet
    fi
    if [ -f "/lib/systemd/system/hornet.service" ]; then
        sudo cp -rf $swarmTemplates/iota/hornet/iota-hornet.service /lib/systemd/system/iota-hornet.service
    fi
    if [ -f "/etc/nginx/sites-enabled/hornet" ]; then
        sudo mv /etc/nginx/sites-enabled/hornet /etc/nginx/sites-enabled/iota-hornet
        sudo systemctl reload nginx
    fi
    if [ ! -f "/etc/systemd/system/multi-user.target.wants/iota-hornet.service" ]; then
        sudo systemctl enable iota-hornet
        sudo systemctl daemon-reload
        sudo systemctl start hornet
    fi
fi

if [ -f "/usr/bin/hornet-shimmer" ]; then
    sudo systemctl stop hornet-shimmer
    [ -f "/etc/systemd/system/multi-user.target.wants/hornet-shimmer.service" ]; then
        sudo systemctl disable hornet-shimmer
        sudo systemctl daemon-reload
    fi
    if [ -d "/var/lib/hornet-shimmer" ]; then
        sudo mv /var/lib/hornet-shimmer /var/lib/shimmer-hornet
    fi
    if [ -f "/usr/bin/hornet-shimmer" ]; then
        sudo mv /usr/bin/hornet-shimmer /usr/bin/shimmer-hornet
    fi
    if [ -f "/etc/default/hornet-shimmer" ]; then
        sudo mv /etc/default/hornet-shimmer /etc/default/shimmer-hornet
    fi
    if [ -f "/lib/systemd/system/hornet.service" ]; then
        sudo cp -rf $swarmTemplates/shimmer/hornet/shimmer-hornet.service /lib/systemd/system/shimmer-hornet.service
        sudo rm -rf /lib/systemd/system/hornet-shimmer.service
    fi
    if [ -f "/etc/nginx/sites-enabled/hornet-shimmer" ]; then
        sudo mv /etc/nginx/sites-enabled/hornet-shimmer /etc/nginx/sites-enabled/shimmer-hornet
        sudo systemctl reload nginx
    fi
    if [ ! -f "/etc/systemd/system/multi-user.target.wants/shimmer-hornet.service" ]; then
        sudo systemctl enable shimmer-hornet
        sudo systemctl daemon-reload
        sudo systemctl start shimmer-hornet
    fi
fi

if [ -f "/usr/bin/bee" ]; then
    sudo systemctl stop bee
    [ -f "/etc/systemd/system/multi-user.target.wants/bee.service" ]; then
        sudo systemctl disable bee
        sudo systemctl daemon-reload
    fi
    if [ -d "/var/lib/bee" ]; then
        sudo mv /var/lib/bee /var/lib/iota-bee
    fi
    if [ -f "/usr/bin/bee" ]; then
        sudo mv /usr/bin/bee /usr/bin/iota-bee
    fi
    if [ -f "/etc/default/bee" ]; then
        sudo mv /etc/default/bee /etc/default/iota-bee
    fi
    if [ -f "/lib/systemd/system/bee.service" ]; then
        sudo cp -rf $swarmTemplates/iota/bee/iota-bee.service /lib/systemd/system/iota-bee.service
    fi
    if [ -f "/etc/nginx/sites-enabled/bee" ]; then
        sudo mv /etc/nginx/sites-enabled/bee /etc/nginx/sites-enabled/iota-bee
        sudo systemctl reload nginx
    fi
    if [ ! -f "/etc/systemd/system/multi-user.target.wants/iota-bee.service" ]; then
        sudo systemctl enable iota-bee
        sudo systemctl daemon-reload
        sudo systemctl start bee
    fi
fi

if [ -f "/usr/bin/bee-shimmer" ]; then
    sudo systemctl stop bee-shimmer
    [ -f "/etc/systemd/system/multi-user.target.wants/bee-shimmer.service" ]; then
        sudo systemctl disable bee-shimmer
        sudo systemctl daemon-reload
    fi
    if [ -d "/var/lib/bee-shimmer" ]; then
        sudo mv /var/lib/bee-shimmer /var/lib/shimmer-bee
    fi
    if [ -f "/usr/bin/bee-shimmer" ]; then
        sudo mv /usr/bin/bee-shimmer /usr/bin/shimmer-bee
    fi
    if [ -f "/etc/default/bee-shimmer" ]; then
        sudo mv /etc/default/bee-shimmer /etc/default/shimmer-bee
    fi
    if [ -f "/lib/systemd/system/bee.service" ]; then
        sudo cp -rf $swarmTemplates/shimmer/bee/shimmer-bee.service /lib/systemd/system/shimmer-bee.service
        sudo rm -rf /lib/systemd/system/bee-shimmer.service
    fi
    if [ -f "/etc/nginx/sites-enabled/bee-shimmer" ]; then
        sudo mv /etc/nginx/sites-enabled/bee-shimmer /etc/nginx/sites-enabled/shimmer-bee
        sudo systemctl reload nginx
    fi
    if [ ! -f "/etc/systemd/system/multi-user.target.wants/shimmer-bee.service" ]; then
        sudo systemctl enable shimmer-bee
        sudo systemctl daemon-reload
        sudo systemctl start shimmer-bee
    fi
fi