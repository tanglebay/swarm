#!/bin/bash

useShimmerWaspEnablePlugins=true
source $shimmerWaspModule/shimmerWaspPlugins

IFS=', ' read -r -a ARRAYshimmerWaspEnablePlugins <<< "$shimmerWaspEnablePlugins"

parser="$(jq '.node.enablePlugins' $shimmerWaspHome/config.json)"
parser="$(echo $parser | tr -d '[]" ')"
if [ "$parser" != "$shimmerWaspEnablePlugins" ]; then
    sudo jq '.node.enablePlugins |= []' $shimmerWaspHome/config.json|sponge $shimmerWaspHome/config.json
    for shimmerWaspEnablePlugin in "${ARRAYshimmerWaspEnablePlugins[@]}"
    do
        sudo jq '.node.enablePlugins |= .+ ["'$shimmerWaspEnablePlugin'"]' $shimmerWaspHome/config.json|sponge $shimmerWaspHome/config.json
    done
    restartShimmerWasp=true
fi

unset ARRAYshimmerWaspEnablePlugins
unset shimmerWaspEnablePlugin
unset useShimmerWaspEnablePlugins