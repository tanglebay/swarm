#!/bin/bash

if [ ! -d "/etc/nginx/swarm/shimmer-wasp" ]; then
    sudo mkdir -p /etc/nginx/swarm/shimmer-wasp
fi

if [ "$shimmerWaspWebapiAuthEnabled" = "true" ]; then
    sudo echo "auth_basic \"Restricted\";" > /etc/nginx/swarm/shimmer-wasp/webapiauth.conf
    sudo echo "auth_basic_user_file /etc/nginx/swarm/shimmer-wasp/.htpasswd_webapi;" >> /etc/nginx/swarm/shimmer-wasp/webapiauth.conf
    if [ -f "/usr/sbin/nginx" ]; then
        sudo systemctl reload nginx > /dev/null 2>&1
    fi
else
    sudo echo "" > /etc/nginx/swarm/shimmer-wasp/webapiauth.conf > /dev/null 2>&1
    if [ -f "/usr/sbin/nginx" ]; then
        sudo systemctl reload nginx > /dev/null 2>&1
    fi
fi
