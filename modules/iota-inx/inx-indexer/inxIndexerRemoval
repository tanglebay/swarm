#!/bin/bash

source $swarmConfigs/inx-indexer.cfg

if [ "$killall" = "true" ]; then
    sudo killall -s SIGKILL inx-indexer > /dev/null 2>&1
else
    sudo systemctl stop inx-indexer > /dev/null 2>&1
fi

if [ ! -f "/usr/bin/inx-mqtt" ] && [ ! -f "/usr/bin/inx-participation" ]; then
    if id inx >/dev/null 2>&1; then
        sudo deluser inx >/dev/null
    fi
fi

sudo systemctl disable inx-indexer > /dev/null 2>&1

sudo rm -rf /usr/bin/inx-indexer /var/lib/inx-indexer /lib/systemd/system/inx-indexer.service /etc/default/inx-indexer > /dev/null 2>&1

sudo systemctl daemon-reload > /dev/null 2>&1

if [ ! -f "/usr/bin/hornet" ] && [ ! -f "/usr/bin/hornet-shimmer" ] && [ ! -f "/usr/bin/goshimmer" ] && [ ! -f "/usr/bin/wasp" ] && [ ! -f "/usr/bin/inx-indexer" ] && [ ! -f "/usr/bin/inx-mqtt" ] && [ ! -f "/usr/bin/inx-participation" ]; then
    sudo snap remove go > /dev/null 2>&1
fi
