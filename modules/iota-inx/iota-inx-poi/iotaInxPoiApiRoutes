#!/bin/bash

iotaInxPoiApiPublicRoutesCurrent=$iotaInxPoiApiPublicRoutes

# Unset VARS
unset iotaInxPoiApiPublicRoutes

#/api/poi/v1/create/*
if [[ $iotaInxPoiApiRoutes = */api/poi/v1/create/\** ]]; then
    iotaInxPoiApiRoutesCreate=OFF
else
    iotaInxPoiApiRoutesCreate=ON
    iotaInxPoiApiPublicRoutes="/api/poi/v1/create/*"
fi

#/api/poi/v1/validate
if [[ $iotaInxPoiApiRoutes = */api/poi/v1/validate* ]]; then
    iotaInxPoiApiRoutesValidate=OFF
else
    iotaInxPoiApiRoutesValidate=ON
    iotaInxPoiApiPublicRoutes=$(echo "$iotaInxPoiApiPublicRoutes,/api/poi/v1/validate")
fi


######

iotaInxPoiApiPublicRoutes=$(echo "$iotaInxPoiApiPublicRoutes" | tr -s ',,' ',')
validateIotaHornetApiPublicRoutes=$(echo "${iotaInxPoiApiPublicRoutes: -1}")
if [ "$validateIotaHornetApiPublicRoutes" = "," ]; then
    iotaInxPoiApiPublicRoutes="${iotaInxPoiApiPublicRoutes%?}"
fi

if [ "$iotaInxPoiUpdateApiRoutes" = "true" ] && [ "$iotaInxPoiApiPublicRoutesCurrent" != "$iotaInxPoiApiPublicRoutes" ]; then
    sudo sed -i 's~^iotaInxPoiApiPublicRoutes=.*~iotaInxPoiApiPublicRoutes="'$iotaInxPoiApiPublicRoutes'"~' $swarmConfigs/iota-inx-poi.cfg
    restartIotaHornet=true
fi

unset iotaInxPoiApiPublicRoutesCurrent
