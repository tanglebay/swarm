#!/bin/bash

# Check if release is changed
if [ "$shimmerBeeRelease" != "$currentShimmerBeeRelease" ]; then
    {
        echo 0
        echo 20
        source $shimmerBeeModules/shimmerBeeRemoval
        echo 40
        source $shimmerBeeModules/shimmerBeeInstaller
        echo 60
        source $shimmerBeeModules/shimmerBeeParser
        echo 80
        if [ "$shimmerBeeUpdated" = "true" ] || [ "$restartShimmerBee" = "true" ]; then
            sudo systemctl restart shimmer-bee
            unset restartShimmerBee
        fi
        echo 100
    } | whiptail --gauge "Please wait while Shimmer-Bee is prepared..." 8 65 0
    whiptail --title "Shimmer-Bee - Configuration" --msgbox "New release channel ($shimmerBeeRelease) applied and Shimmer-Bee was reinstalled!" 8 65
fi