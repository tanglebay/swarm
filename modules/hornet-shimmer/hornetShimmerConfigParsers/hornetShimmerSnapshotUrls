#!/bin/bash
if [ "$hornetShimmerNetwork" = "mainnet" ] || [ "$hornetShimmerNetwork" = "alphanet" ]; then
    hornetShimmerFullSnapshotOld="https://cdn.tanglebay.com/snapshots/shimmernet/full_snapshot.bin"
    hornetShimmerDeltaSnapshotOld="https://cdn.tanglebay.com/snapshots/shimmernet/delta_snapshot.bin"
    hornetShimmerFullSnapshot="https://cdn.tanglebay.com/snapshots/shimmer-mainnet/full_snapshot.bin"
    hornetShimmerDeltaSnapshot="https://cdn.tanglebay.com/snapshots/shimmer-mainnet/delta_snapshot.bin"
    parser="$(jq '.snapshots.downloadURLs' $hornetShimmerHome/config.json)"
    if [[ $parser = *$hornetShimmerFullSnapshotOld* ]] && [[ $parser = *$hornetShimmerDeltaSnapshotOld* ]]; then
        sudo sudo sed -i 's~'$hornetShimmerFullSnapshotOld'~'$hornetShimmerFullSnapshot'~g' $hornetShimmerHome/config.json
        sudo sudo sed -i 's~'$hornetShimmerDeltaSnapshotOld'~'$hornetShimmerDeltaSnapshot'~g' $hornetShimmerHome/config.json
        echo "hornetShimmerSnapshotUrl" >> /tmp/hornetShimmerParsing
    fi
    parser="$(jq '.snapshots.downloadURLs' $hornetShimmerHome/config.json)"
    if [[ $parser != *$hornetShimmerFullSnapshot* ]] && [[ $parser != *$hornetShimmerDeltaSnapshot* ]]; then
        sudo jq '.snapshots.downloadURLs[.snapshots.downloadURLs| length] |= . + {"full": "'$hornetShimmerFullSnapshot'","delta": "'$hornetShimmerDeltaSnapshot'"}' $hornetShimmerHome/config.json|sponge $hornetShimmerHome/config.json
        restartHornetShimmer=true
        echo "hornetShimmerSnapshotUrl" >> /tmp/hornetShimmerParsing
    fi
    unset parser hornetShimmerFullSnapshot
fi