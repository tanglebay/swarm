#!/bin/bash

parser="$(jq '.prometheus.bindAddress' $hornetShimmerHome/$hornetShimmerConfig.json)"
parser=$(echo $parser | tr -d '"')
if [ "$parser" != "localhost:9312" ]; then
    sudo jq '.prometheus.bindAddress = "localhost:9312"' $hornetShimmerHome/$hornetShimmerConfig.json|sponge $hornetShimmerHome/$hornetShimmerConfig.json
    restartHornetShimmer=true
    echo "hornetShimmerPrometheus1" >> /tmp/hornetShimmerParsing
fi
parser="$(jq '.prometheus.fileServiceDiscovery.target' $hornetShimmerHome/$hornetShimmerConfig.json)"
parser=$(echo $parser | tr -d '"')
if [ "$parser" != "localhost:9312" ]; then
    sudo jq '.prometheus.fileServiceDiscovery.target = "localhost:9312"' $hornetShimmerHome/$hornetShimmerConfig.json|sponge $hornetShimmerHome/$hornetShimmerConfig.json
    restartHornetShimmer=true
    echo "hornetShimmerPrometheus2" >> /tmp/hornetShimmerParsing
fi