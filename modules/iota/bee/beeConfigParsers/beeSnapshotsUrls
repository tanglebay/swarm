#!/bin/bash
if [ "$beeNetwork" = "mainnet" ] || [ "$beeNetwork" = "alphanet" ]; then
    beeFullSnapshotOld="https://cdn.tanglebay.com/snapshots/mainnet/full_snapshot.bin"
    beeDeltaSnapshotOld="https://cdn.tanglebay.com/snapshots/mainnet/delta_snapshot.bin"
    beeFullSnapshot="https://cdn.tanglebay.com/snapshots/iota-mainnet/full_snapshot.bin"
    beeDeltaSnapshot="https://cdn.tanglebay.com/snapshots/iota-mainnet/delta_snapshot.bin"
    parser="$(jq '.snapshots.downloadURLs' $beeHome/config.json)"
    if [[ $parser = *$beeFullSnapshotOld* ]] && [[ $parser = *$beeDeltaSnapshotOld* ]]; then
        sudo sudo sed -i 's~'$beeFullSnapshotOld'~'$beeFullSnapshot'~g' $beeHome/config.json
        sudo sudo sed -i 's~'$beeDeltaSnapshotOld'~'$beeDeltaSnapshot'~g' $beeHome/config.json
        restartBee=true
        echo "beeSnapshotUrl" >> /tmp/beeParsing
    fi
    parser="$(jq '.snapshots.downloadURLs' $beeHome/config.json)"
    if [[ $parser != *$beeFullSnapshot* ]] && [[ $parser != *$beeDeltaSnapshot* ]]; then
        sudo jq '.snapshots.downloadURLs[.snapshots.downloadURLs| length] |= . + {"full": "'$beeFullSnapshot'","delta": "'$beeDeltaSnapshot'"}' $beeHome/config.json|sponge $beeHome/config.json
        restartBee=true
        echo "beeSnapshotUrl" >> /tmp/beeParsing
    fi
    unset parser beeFullSnapshot
fi