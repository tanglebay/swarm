#!/bin/bash
if [ "$iotaBeeNetwork" = "mainnet" ]; then
    parser="$(jq '.autopeering.entryNodes' $iotaBeeHome/$iotaBeeConfig.json)"
    iotaBeeEntryNodeOld="/dns/entry-0.shimmer-mainnet.tanglebay.com/udp/14636/autopeering/iot4By1FD4pFLrGJ6AAe7YEeSu9RbW9xnPUmxMdQenC"
    if [[ $parser = *$iotaBeeEntryNodeOld* ]]; then
        iotaBeeEntryNode="/dns/entry-0.iota-mainnet.tanglebay.com/udp/14626/autopeering/iot4By1FD4pFLrGJ6AAe7YEeSu9RbW9xnPUmxMdQenC"
        sudo sudo sed -i 's~'$iotaBeeEntryNodeOld'~'$iotaBeeEntryNode'~g' $iotaBeeHome/$iotaBeeConfig.json
        restartIotaBee=true
        echo "iotaBeeEntrynodes" >> /tmp/iotaBeeParsing
    fi
    iotaBeeEntryNodeOld="/dns/entry-1.shimmer-mainnet.tanglebay.com/udp/14626/autopeering/CATsx21mFVvQQPXeDineGs9DDeKvoBBQdzcmR6ffCkVA"
    if [[ $parser = *$iotaBeeEntryNodeOld* ]]; then
        iotaBeeEntryNode="/dns/entry-1.iota-mainnet.tanglebay.com/udp/14626/autopeering/CATsx21mFVvQQPXeDineGs9DDeKvoBBQdzcmR6ffCkVA"
        sudo sudo sed -i 's~'$iotaBeeEntryNodeOld'~'$iotaBeeEntryNode'~g' $iotaBeeHome/$iotaBeeConfig.json
        restartIotaBee=true
        echo "iotaBeeEntrynodes" >> /tmp/iotaBeeParsing
    fi
    unset iotaBeeEntryNodeOld
    ####################################################################################################################################################
    parser="$(jq '.autopeering.entryNodes' $iotaBeeHome/$iotaBeeConfig.json)"
    iotaBeeEntryNode="/dns/entry-0.iota-mainnet.tanglebay.com/udp/14626/autopeering/iot4By1FD4pFLrGJ6AAe7YEeSu9RbW9xnPUmxMdQenC"
    if [[ $parser != *$iotaBeeEntryNode* ]]; then
        sudo jq '.autopeering.entryNodes |= .+ ["'$iotaBeeEntryNode'"]' $iotaBeeHome/$iotaBeeConfig.json|sponge $iotaBeeHome/$iotaBeeConfig.json
        restartIotaBee=true
        echo "iotaBeeEntrynodes" >> /tmp/iotaBeeParsing
    fi
    iotaBeeEntryNode="/dns/entry-1.iota-mainnet.tanglebay.com/udp/14626/autopeering/CATsx21mFVvQQPXeDineGs9DDeKvoBBQdzcmR6ffCkVA"
    if [[ $parser != *$iotaBeeEntryNode* ]]; then
        sudo jq '.autopeering.entryNodes |= .+ ["'$iotaBeeEntryNode'"]' $iotaBeeHome/$iotaBeeConfig.json|sponge $iotaBeeHome/$iotaBeeConfig.json
        restartIotaBee=true
        echo "iotaBeeEntrynodes" >> /tmp/iotaBeeParsing
    fi
    unset parser iotaBeeEntryNode
fi