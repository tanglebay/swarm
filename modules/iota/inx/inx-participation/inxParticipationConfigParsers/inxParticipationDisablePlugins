#!/bin/bash

useInxParticipationDisablePlugins=true
source $inxParticipationModules/inxParticipationPlugins

IFS=', ' read -r -a ARRAYinxParticipationDisablePlugins <<< "$inxParticipationDisablePlugins"

parser="$(jq '.app.disablePlugins' $inxParticipationHome/$inxParticipationConfig.json)"
parser="$(echo $parser | tr -d '[]" ')"
if [ "$parser" != "$inxParticipationDisablePlugins" ]; then
    sudo jq '.app.disablePlugins |= []' $inxParticipationHome/$inxParticipationConfig.json|sponge $inxParticipationHome/$inxParticipationConfig.json
    for inxParticipationDisablePlugin in "${ARRAYinxParticipationDisablePlugins[@]}"
    do
        if [ ! -z "$inxParticipationDisablePlugin" ]; then
            sudo jq '.app.disablePlugins |= .+ ["'$inxParticipationDisablePlugin'"]' $inxParticipationHome/$inxParticipationConfig.json|sponge $inxParticipationHome/$inxParticipationConfig.json
        fi
    done
    restartInxParticipation=true
    echo "inxParticipationDisablePlugins" >> /tmp/inxParticipationParsing
fi
unset ARRAYinxParticipationDisablePlugins inxParticipationDisablePlugin useInxParticipationDisablePlugins
