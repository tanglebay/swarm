#!/bin/bash
if [ "$shimmerHornetNetwork" = "mainnet" ] || [ "$shimmerHornetNetwork" = "alphanet" ]; then
    shimmerHornetFullSnapshotOld="https://cdn.tanglebay.com/snapshots/shimmernet/full_snapshot.bin"
    shimmerHornetDeltaSnapshotOld="https://cdn.tanglebay.com/snapshots/shimmernet/delta_snapshot.bin"
    shimmerHornetFullSnapshot="https://cdn.tanglebay.com/snapshots/shimmer-mainnet/full_snapshot.bin"
    shimmerHornetDeltaSnapshot="https://cdn.tanglebay.com/snapshots/shimmer-mainnet/delta_snapshot.bin"
    parser="$(jq '.snapshots.downloadURLs' $shimmerHornetHome/$shimmerHornetConfig)"
    if [[ $parser = *$shimmerHornetFullSnapshotOld* ]] && [[ $parser = *$shimmerHornetDeltaSnapshotOld* ]]; then
        sudo sudo sed -i 's~'$shimmerHornetFullSnapshotOld'~'$shimmerHornetFullSnapshot'~g' $shimmerHornetHome/$shimmerHornetConfig
        sudo sudo sed -i 's~'$shimmerHornetDeltaSnapshotOld'~'$shimmerHornetDeltaSnapshot'~g' $shimmerHornetHome/$shimmerHornetConfig
        restartShimmerHornet=true
        echo "shimmerHornetSnapshotUrl" >> /tmp/shimmerHornetParsing
    fi
    parser="$(jq '.snapshots.downloadURLs' $shimmerHornetHome/$shimmerHornetConfig)"
    if [[ $parser != *$shimmerHornetFullSnapshot* ]] && [[ $parser != *$shimmerHornetDeltaSnapshot* ]]; then
        sudo jq '.snapshots.downloadURLs[.snapshots.downloadURLs| length] |= . + {"full": "'$shimmerHornetFullSnapshot'","delta": "'$shimmerHornetDeltaSnapshot'"}' $shimmerHornetHome/$shimmerHornetConfig|sponge $shimmerHornetHome/$shimmerHornetConfig
        restartShimmerHornet=true
        echo "shimmerHornetSnapshotUrl" >> /tmp/shimmerHornetParsing
    fi
    unset parser shimmerHornetFullSnapshot
fi