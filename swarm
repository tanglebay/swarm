#!/bin/bash
############################################################################################################################################################
############################################################################################################################################################
# DO NOT EDIT THE LINES BELOW !!! DO NOT EDIT THE LINES BELOW !!! DO NOT EDIT THE LINES BELOW !!! DO NOT EDIT THE LINES BELOW !!!
############################################################################################################################################################
############################################################################################################################################################

source /var/lib/swarm/environment

############################################################################################################################################################

# Run PACKAGE module
source $swarmHome/packages

# Get Version
source $swarmHome/version

# Console
source $swarmHome/console

# Run module sudo check
source $swarmHome/requirements

# Run alias module
source $swarmModules/swarmAlias

# Load Theme
source $swarmModules/swarmTheme

# Start main script
exitCode=0
while [ $exitCode -lt 1 ]; do
    clear
    source $swarmConfigs/proxy.cfg
    source $swarmConfigs/swarm.cfg
    source $swarmConfigs/watchdog.cfg
    source $swarmConfigs/latest-versions.cfg

    ############################################################################################################################################################

    if [ "$version" != "$latestSwarmVersion" ] && [ ! -z "$latestSwarmVersion" ]; then
        swarmVersionText="v$version - New Version v$latestSwarmVersion available!"
    else
        swarmVersionText="v$version"
    fi

    source $swarmModules/swarmAuth

    CHOICE=$(
        whiptail --title "SWARM [$swarmVersionText]" --menu "\nAuth Status: $swarmAuthText\n\nChoose an option:" 24 65 0 \
        "1)" "SWARM Menu" \
        "2)" "Hornet Menu" \
        "3)" "Bee Menu" \
        "4)" "INX Menu" \
        "5)" "GoShimmer Menu" \
        "6)" "WASP Menu" \
        "7)" "Proxy Menu" \
        "8)" "About SWARM" 3>&2 2>&1 1>&3
    )
    exitStatus=$?
    if [ "$exitStatus" = "1" ]; then
        clear
        exit 0
    fi

    case $CHOICE in
        "1)")
            # SWARM Menu
            source $swarmModules/swarmMenu
        ;;
        "2)")
            while [ $exitCode -lt 1 ]; do
                clear
                CHOICE=$(
                    whiptail --title "Hornet - Menu" --menu "\nChoose an option" 24 65 0 \
                    "1)" "Hornet (IOTA)" \
                    "2)" "Hornet (Shimmer)" 3>&2 2>&1 1>&3
                )
                exitstatus=$?
                if [ "$exitstatus" = "1" ]; then
                    exitCode=1
                fi
                case $CHOICE in
                    "1)")
                        source $iotaHornetModules/hornetMenu
                    ;;
                    "2)")
                        source $shimmerHornetModules/hornetMenu
                    ;;
                esac
            done
            exitCode=0
        ;;
        "3)")
            while [ $exitCode -lt 1 ]; do
                clear
                CHOICE=$(
                    whiptail --title "Bee - Menu" --menu "\nChoose an option" 24 65 0 \
                    "1)" "Bee (IOTA)" \
                    "2)" "Bee (Shimmer)" 3>&2 2>&1 1>&3
                )
                exitstatus=$?
                if [ "$exitstatus" = "1" ]; then
                    exitCode=1
                fi
                case $CHOICE in
                    "1)")
                        source $iotaBeeModules/beeMenu
                    ;;
                    "2)")
                        source $shimmerBeeModules/beeMenu
                    ;;
                esac
            done
            exitCode=0
        ;;
        "4)")
            while [ $exitCode -lt 1 ]; do
                clear
                CHOICE=$(
                    whiptail --title "INX - Menu" --menu "\nChoose an option" 24 65 0 \
                    "1)" "INX (IOTA)" \
                    "2)" "INX (Shimmer)" 3>&2 2>&1 1>&3
                )
                exitstatus=$?
                if [ "$exitstatus" = "1" ]; then
                    exitCode=1
                fi
                case $CHOICE in
                    "1)")
                        source $iotaInxModules/inxMenu
                    ;;
                    "2)")
                        source $shimmerInxModules/inxMenu
                    ;;
                esac
            done
            exitCode=0
        ;;
        "5)")
            # GOSHIMMER MENU
            source $goshimmerModules/goshimmerMenu
        ;;
        "6)")
            # WASP MENU
            source $waspModules/waspMenu
        ;;
        "7)")
            # PROXY MENU
            source $proxyModules/proxyMenu
        ;;
        "8)")
            source $swarmHome/about
        ;;
    esac
done

############################################################################################################################################################

exitCode=0
clear
exit 0
